<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>INT20H - Timer</title>
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"
    />

    <link href="favicon.png" rel="icon" type="image/x-icon" />
    <link rel="stylesheet" href="css/reset.css" />
    <link rel="stylesheet" href="css/style.css" />
  </head>
  <body>
    <div id="logos" class="hidden">
      <img src="logos/evo.svg" />
      <img src="logos/modus-x.svg" />
      <img src="logos/anbosoft.svg" />
      <img src="logos/logitech.svg" />

      <img src="logos/skelar.svg" />
      <img src="logos/dim-ria.svg" />
      <img src="logos/futura-group.svg" />

      <img src="logos/support-your-app.svg" />
      <img src="logos/sombra.svg" />
      <img src="logos/robocode.svg" />
      <img src="logos/unicorn.svg" />
      <img src="logos/reprezent.svg" />
      <img src="logos/tv7-studio.svg" />

      <img src="logos/burunduk.png" />
      <img src="logos/yavereta.svg" />
      <img src="logos/gtea.svg" />
      <img src="logos/easy-drive.svg" />
      <img src="logos/jooble.svg" />
      <img src="logos/happy-monday.svg" />
      <img src="logos/best.svg" />
      <img src="logos/kpi.svg" />
    </div>

    <div id="timer">
      <div id="clock">
        <span class="hours"
          ><span class="first digit">2</span
          ><span class="second digit">0</span></span
        >:<span class="minutes"
          ><span class="first digit">0</span
          ><span class="second digit">0</span></span
        >:<span class="seconds"
          ><span class="first digit">0</span
          ><span class="second digit">0</span></span
        >
      </div>
      <div id="tools" class="hidden">
        <div id="start">
          <div class="play">
            <span class="material-symbols-outlined"> play_arrow </span>
          </div>
          <div class="pause">
            <span class="material-symbols-outlined"> pause </span>
          </div>
        </div>
        <div id="restart">
          <span class="material-symbols-outlined"> restart_alt </span>
        </div>
        <div id="settings">
          <span class="material-symbols-outlined"> settings </span>
        </div>
        <div id="type">
          <span class="option coding active">coding</span>
          <span class="option presentation">presentation</span>
          <span class="option questions">questions</span>
        </div>
      </div>
    </div>

    <div id="background"></div>

    <script>
      const logosIntervalInMinutes = 2;
      var hours = 20;
      var minutes = 00;
      var seconds = 00;
      let initialHours = 20;
      let initialMinutes = 00;
      let initialSeconds = 00;
      var interval;
      var started = false;
      var type = "coding";
      let settingsActive = false;

      var logosContainer = document.getElementById("logos");
      var logos = logosContainer.querySelectorAll("img");
      var logosInterval;
      var clock = document.getElementById("clock");
      var hoursField = clock.querySelector(".hours");
      var minutesField = clock.querySelector(".minutes");
      var secondsField = clock.querySelector(".seconds");

      var tools = document.getElementById("tools");
      var startButton = document.getElementById("start");
      var restartButton = document.getElementById("restart");
      const settingsButton = document.getElementById("settings");
      var codingOption = tools.querySelector("#type .option.coding");
      var presentationOption = tools.querySelector(
        "#type .option.presentation",
      );
      var questionsOption = tools.querySelector("#type .option.questions");

      var bg = document.getElementById("background");

      function reloadTimer() {
        hoursField.querySelector(".first").textContent =
          hours < 10 ? 0 : Math.floor(hours / 10);
        hoursField.querySelector(".second").textContent =
          hours - Math.floor(hours / 10) * 10;

        minutesField.querySelector(".first").textContent =
          minutes < 10 ? 0 : Math.floor(minutes / 10);
        minutesField.querySelector(".second").textContent =
          minutes - Math.floor(minutes / 10) * 10;

        secondsField.querySelector(".first").textContent =
          seconds < 10 ? 0 : Math.floor(seconds / 10);
        secondsField.querySelector(".second").textContent =
          seconds - Math.floor(seconds / 10) * 10;
      }

      function recountTime() {
        if (hours === 0 && minutes === 0 && seconds === 0)
          clearInterval(interval);
        else if (seconds === 0) {
          seconds = 59;
          if (minutes > 0) minutes--;
          else if (hours > 0) {
            minutes = 59;
            hours--;
          }
        } else seconds--;

        reloadTimer();
      }

      function startTimer() {
        startButton.classList.add("started");
        started = true;
        recountTime();
        interval = setInterval(recountTime, 1000);
        if (type === "coding")
          logosInterval = setInterval(
            showLogos,
            logosIntervalInMinutes * 60 * 1000,
          );
        bg.classList.add("animate");
      }

      function pauseTimer() {
        startButton.classList.remove("started");
        started = false;
        clearInterval(interval);
        clearInterval(logosInterval);
        bg.classList.remove("animate");
      }

      startButton.onclick = function () {
        if (settingsActive) {
          const hoursInput = document
            .getElementById("hoursInput")
            .value.padStart(2, "0");
          const minutesInput = document
            .getElementById("minutesInput")
            .value.padStart(2, "0");
          const secondsInput = document
            .getElementById("secondsInput")
            .value.padStart(2, "0");
          hours = +hoursInput;
          minutes = +minutesInput;
          seconds = +secondsInput;
          initialHours = hours;
          initialMinutes = minutes;
          initialSeconds = seconds;
          clock.innerHTML = `<span class="hours"
          ><span class="first digit">${hoursInput[0]}</span
          ><span class="second digit">${hoursInput[1]}</span></span
        >:<span class="minutes"
          ><span class="first digit">${minutesInput[0]}</span
          ><span class="second digit">${minutesInput[1]}</span></span
        >:<span class="seconds"
          ><span class="first digit">${secondsInput[0]}</span
          ><span class="second digit">${secondsInput[1]}</span></span
        >`;
          hoursField = clock.querySelector(".hours");
          minutesField = clock.querySelector(".minutes");
          secondsField = clock.querySelector(".seconds");
          settingsActive = false;
        }
        if (started) {
          pauseTimer();
        } else {
          startTimer();
        }
      };

      restartButton.onclick = function () {
        pauseTimer();
        switch (type) {
          case "coding":
            hours = initialHours;
            minutes = initialMinutes;
            seconds = initialSeconds;
            break;
          case "presentation":
            hours = 0;
            minutes = 7;
            seconds = 0;
            break;
          case "qustions":
            hours = 0;
            minutes = 3;
            seconds = 0;
            break;
        }
        reloadTimer();
      };

      codingOption.onclick = function () {
        pauseTimer();
        codingOption.classList.add("active");
        presentationOption.classList.remove("active");
        questionsOption.classList.remove("active");
        type = "coding";
        hours = 20;
        minutes = 0;
        seconds = 0;
        reloadTimer();
      };

      presentationOption.onclick = function () {
        pauseTimer();
        presentationOption.classList.add("active");
        codingOption.classList.remove("active");
        questionsOption.classList.remove("active");
        type = "presentation";
        hours = 0;
        minutes = 7;
        seconds = 0;
        reloadTimer();
      };

      settingsButton.onclick = function () {
        pauseTimer();
        settingsActive = true;
        hoursField.classList.add(".hidden");
        minutesField.classList.add(".hidden");
        secondsField.classList.add(".hidden");
        clock.innerHTML = `
            <input id="hoursInput" autocomplete="off">
            :<input id="minutesInput" autocomplete="off">
            :<input id="secondsInput" autocomplete="off">`;
      };

      questionsOption.onclick = function () {
        pauseTimer();
        questionsOption.classList.add("active");
        codingOption.classList.remove("active");
        presentationOption.classList.remove("active");
        type = "qustions";
        hours = 0;
        minutes = 3;
        seconds = 0;
        reloadTimer();
      };

      document.onmousemove = function () {
        if (tools.classList.contains("hidden")) {
          tools.classList.remove("hidden");
          setTimeout(function () {
            tools.classList.add("hidden");
          }, 3000);
        }
        logosContainer.classList.add("hidden");
        timer.classList.remove("hidden");
      };

      function showLogos() {
        logosContainer.classList.remove("hidden");
        timer.classList.add("hidden");

        [].forEach.call(logos, function (logo, i) {
          setTimeout(function () {
            if (i) logos[i - 1].classList.remove("active");
            logo.classList.add("active");
            if (i + 1 === logos.length)
              setTimeout(function () {
                logo.classList.remove("active");
              }, 3000);
          }, 3000 * i);
        });

        setTimeout(function () {
          logosContainer.classList.add("hidden");
          timer.classList.remove("hidden");
        }, logos.length * 3000);
      }
    </script>
  </body>
</html>
